int XD3D_AppIDDEnumCallback(_GUID* pGUID, signed char* lpDriverDescription, signed char* lpDriverName, void* lpContext)
{
	IDirectDraw7* pDD = 0;
	if(!DirectDrawCreateEx(pGUID, (LPVOID*)&pDD, &IID_IDirectDraw7, 0))
		if(pGUID)
			dxDeviceGUIDflag = 1;
			dxDeviceGUID = *pGUID;
		else
			dxDeviceGUIDflag = 0;
		pDD->GetDeviceIdentifier(&dddi, 0);
		int curDriver = 0;
		IDirect3D7* pD3D;
		if(!pDD->QueryInterface(IID_IDirect3D7, (void**)&pD3D))
			pD3D->EnumDevices(XD3D_EnumDeviceCallback, &curDriver);
			dxDeviceModeNum[dxDeviceNumber] = 0;
			pDD->EnumDisplayModes(0, 0, 0, XD3D_EnumModesCallback);
			if(dxDeviceModeNum[dxDeviceNumber] > 0)
				dxDeviceNumber += 1;
		if(pD3D)
			pD3D->Release();
			pD3D = 0;
	if(pDD)
		pDD->Release();
	return dxDeviceNum - 1 != dxSelectDevice;
}
